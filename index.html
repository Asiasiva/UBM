<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Business ERP Pro v10</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #F2F2F7; /* iOS System Gray 6 */
            color: #1C1C1E;
            -webkit-tap-highlight-color: transparent;
        }

        .hide-scroll::-webkit-scrollbar { display: none; }
        .hide-scroll { -ms-overflow-style: none; scrollbar-width: none; }

        .animate-enter { animation: enter 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); }
        @keyframes enter { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .ios-card {
            background: white;
            border-radius: 18px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            padding: 20px;
            border: 1px solid rgba(0,0,0,0.03);
        }

        .ios-input {
            background: #F2F2F7;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 15px;
            width: 100%;
            transition: all 0.2s;
        }
        .ios-input:focus {
            background: #E5E5EA;
            outline: none;
        }

        .ios-btn {
            border-radius: 12px;
            font-weight: 600;
            transition: transform 0.1s;
        }
        .ios-btn:active { transform: scale(0.96); }

        .ios-nav {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .details-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .details-open { max-height: 500px; }

        @media print {
            body * { visibility: hidden; }
            #print-preview-modal, #print-preview-modal * { visibility: visible; }
            #print-preview-modal { 
                position: absolute; left: 0; top: 0; width: 100%; height: auto; 
                background: white; z-index: 9999; padding: 0; margin: 0; overflow: visible;
            }
            .no-print { display: none !important; }
            @page { size: A4; margin: 10mm; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons
        const Icon = ({ p, c }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={c} dangerouslySetInnerHTML={{__html: p}} />;
        const I = {
            home: '<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline>',
            plus: '<line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line>',
            settings: '<circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>',
            arrowL: '<line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline>',
            trash: '<polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>',
            print: '<polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect>',
            download: '<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line>',
            edit: '<path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>',
            grid: '<rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect>',
            chevronD: '<polyline points="6 9 12 15 18 9"></polyline>',
            clock: '<circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>',
            user: '<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle>'
        };

        const formatCurrency = (n) => {
            const num = parseFloat(n) || 0;
            return new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(num);
        };

        // --- Simple Pie Chart ---
        const SimplePieChart = ({ data, colors }) => {
            const total = data.reduce((s, d) => s + (d.value || 0), 0);
            if (total === 0) return <div className="text-xs text-center text-gray-400 py-4">No data to display</div>;
            
            let currentAngle = 0;
            return (
                <div className="flex items-center justify-center gap-6">
                    <svg viewBox="0 0 100 100" className="w-24 h-24 transform -rotate-90">
                        {data.map((d, i) => {
                            if (!d.value || d.value === 0) return null;
                            const angle = (d.value / total) * 360;
                            const isFullCircle = angle >= 359.9;
                            const large = angle > 180 ? 1 : 0;
                            const x1 = 50 + 50 * Math.cos(Math.PI * currentAngle / 180);
                            const y1 = 50 + 50 * Math.sin(Math.PI * currentAngle / 180);
                            const x2 = 50 + 50 * Math.cos(Math.PI * (currentAngle + angle) / 180);
                            const y2 = 50 + 50 * Math.sin(Math.PI * (currentAngle + angle) / 180);
                            
                            const path = isFullCircle 
                                ? "M 50 50 m -49, 0 a 49,49 0 1,0 98,0 a 49,49 0 1,0 -98,0" 
                                : `M 50 50 L ${x1} ${y1} A 50 50 0 ${large} 1 ${x2} ${y2} Z`;
                            
                            currentAngle += angle;
                            return <path key={i} d={path} fill={colors[i]} stroke="white" strokeWidth="2"/>;
                        })}
                    </svg>
                    <div className="text-xs space-y-2">
                        {data.map((d, i) => (
                            <div key={i} className="flex items-center gap-2">
                                <div className="w-3 h-3 rounded-full shadow-sm" style={{backgroundColor: colors[i]}}></div>
                                <span className="font-medium text-gray-600">{d.name}: {Math.round(((d.value||0)/total)*100)}%</span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        function App() {
            const [tab, setTab] = useState('dashboard');
            const [history, setHistory] = useState(['dashboard']);

            // Data States
            const [txns, setTxns] = useState(() => JSON.parse(localStorage.getItem('erp_txns')||'[]'));
            const [inventory, setInventory] = useState(() => JSON.parse(localStorage.getItem('erp_inv')||'[]'));
            const [invoices, setInvoices] = useState(() => JSON.parse(localStorage.getItem('erp_bills')||'[]'));
            const [invoiceItems, setInvoiceItems] = useState(() => JSON.parse(localStorage.getItem('erp_inv_items')||'[]'));
            const [loans, setLoans] = useState(() => JSON.parse(localStorage.getItem('erp_loans')||'[]'));
            const [contacts, setContacts] = useState(() => JSON.parse(localStorage.getItem('erp_contacts')||'[]'));
            
            // Updated Staff Data Structure
            const [staff, setStaff] = useState(() => JSON.parse(localStorage.getItem('erp_staff')||'[]'));
            const [attendance, setAttendance] = useState(() => JSON.parse(localStorage.getItem('erp_att')||'[]'));
            const [staffPayments, setStaffPayments] = useState(() => JSON.parse(localStorage.getItem('erp_staff_pay')||'[]'));

            const [tasks, setTasks] = useState(() => JSON.parse(localStorage.getItem('erp_tasks')||'[]'));
            const [company, setCompany] = useState(() => JSON.parse(localStorage.getItem('erp_company')||'{"name":"My Business"}'));
            const [projects, setProjects] = useState(() => JSON.parse(localStorage.getItem('erp_projects')||'["General"]'));
            const [cats, setCats] = useState(() => JSON.parse(localStorage.getItem('erp_cats')||'{"inc":["Sales"], "exp":["Purchase"]}'));
            const [modules, setModules] = useState(() => JSON.parse(localStorage.getItem('erp_modules')||'{"entry":true,"invoices":true,"inventory":true,"loans":true,"contacts":true,"staff":true}'));

            // Persist
            useEffect(() => {
                const store = {erp_txns:txns, erp_inv:inventory, erp_bills:invoices, erp_inv_items:invoiceItems, erp_loans:loans, erp_contacts:contacts, erp_staff:staff, erp_att:attendance, erp_staff_pay:staffPayments, erp_tasks:tasks, erp_company:company, erp_projects:projects, erp_cats:cats, erp_modules:modules};
                Object.keys(store).forEach(k => localStorage.setItem(k, JSON.stringify(store[k])));
            }, [txns, inventory, invoices, invoiceItems, loans, contacts, staff, attendance, staffPayments, tasks, company, projects, cats, modules]);

            const nav = (t) => { if(tab!==t) { setHistory([...history, t]); setTab(t); window.scrollTo(0,0); } };
            const back = () => { if(history.length>1) { const h=[...history]; h.pop(); setHistory(h); setTab(h[h.length-1]); } };

            return (
                <div className="max-w-2xl mx-auto min-h-screen pb-24">
                    {/* Header */}
                    <div className="sticky top-0 z-30 bg-white/80 backdrop-blur-md border-b border-gray-200 px-4 py-3 flex items-center justify-between no-print">
                        <div className="flex items-center gap-3">
                            {history.length > 1 && <button onClick={back} className="p-2 bg-gray-100 rounded-full hover:bg-gray-200"><Icon p={I.arrowL}/></button>}
                            <h1 className="font-bold text-xl text-gray-900 tracking-tight">Business ERP</h1>
                        </div>
                        <div className="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold text-xs shadow-md">v10</div>
                    </div>

                    <div className="p-4 space-y-4">
                        {tab === 'dashboard' && <Dashboard txns={txns} nav={nav} modules={modules} />}
                        {tab === 'entry' && <EntryManager txns={txns} setTxns={setTxns} cats={cats} projects={projects} />}
                        {tab === 'invoices' && <InvoiceManager invoices={invoices} setInvoices={setInvoices} company={company} contacts={contacts} items={invoiceItems} setItems={setInvoiceItems} />}
                        {tab === 'inventory' && <InventoryManager inventory={inventory} setInventory={setInventory} />}
                        {tab === 'loans' && <LoanManager loans={loans} setLoans={setLoans} contacts={contacts} />}
                        {tab === 'contacts' && <ContactManager contacts={contacts} setContacts={setContacts} />}
                        {tab === 'staff' && <AdvancedStaffManager staff={staff} setStaff={setStaff} attendance={attendance} setAttendance={setAttendance} payments={staffPayments} setPayments={setStaffPayments} />}
                        {tab === 'tasks' && <TaskManager tasks={tasks} setTasks={setTasks} />}
                        {tab === 'settings' && <SettingsManager company={company} setCompany={setCompany} projects={projects} setProjects={setProjects} cats={cats} setCats={setCats} modules={modules} setModules={setModules} fullData={{txns, inventory, invoices, loans, contacts}} />}
                    </div>

                    {/* Bottom Nav */}
                    <div className="ios-nav fixed bottom-0 w-full max-w-2xl flex justify-around p-3 pb-6 z-40 no-print">
                        <button onClick={()=>nav('dashboard')} className={`flex flex-col items-center gap-1 ${tab==='dashboard'?'text-blue-600':'text-gray-400'}`}><Icon p={I.home} c={tab==='dashboard'?'stroke-2':'stroke-1'}/><span className="text-[10px] font-medium">Home</span></button>
                        <button onClick={()=>nav('entry')} className="bg-blue-600 text-white w-12 h-12 rounded-full flex items-center justify-center -mt-6 shadow-lg shadow-blue-200 ios-btn"><Icon p={I.plus}/></button>
                        <button onClick={()=>nav('settings')} className={`flex flex-col items-center gap-1 ${tab==='settings'?'text-blue-600':'text-gray-400'}`}><Icon p={I.settings} c={tab==='settings'?'stroke-2':'stroke-1'}/><span className="text-[10px] font-medium">Settings</span></button>
                    </div>
                </div>
            );
        }

        // --- DASHBOARD ---
        const Dashboard = ({ txns, nav, modules }) => {
            const inc = txns.filter(t=>t.type==='inc').reduce((s,t)=>s+(parseFloat(t.amt)||0),0);
            const exp = txns.filter(t=>t.type==='exp').reduce((s,t)=>s+(parseFloat(t.amt)||0),0);
            const pieData = [{name: 'Income', value: inc}, {name: 'Expense', value: exp}];
            
            return (
                <div className="animate-enter space-y-5">
                    <div className="grid grid-cols-3 gap-3">
                        <div className="ios-card !p-3 text-center bg-white"><div className="text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1">Income</div><div className="text-sm font-bold text-emerald-600">{formatCurrency(inc)}</div></div>
                        <div className="ios-card !p-3 text-center bg-white"><div className="text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1">Expense</div><div className="text-sm font-bold text-rose-600">{formatCurrency(exp)}</div></div>
                        <div className="ios-card !p-3 text-center bg-white"><div className="text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1">Balance</div><div className="text-sm font-bold text-blue-600">{formatCurrency(inc-exp)}</div></div>
                    </div>

                    <div className="ios-card">
                        <h4 className="text-xs font-bold text-gray-400 uppercase mb-4 text-center">Cash Flow</h4>
                        <SimplePieChart data={pieData} colors={['#10B981', '#F43F5E']} />
                    </div>

                    <h3 className="text-lg font-bold text-gray-800 px-1">Apps</h3>
                    <div className="grid grid-cols-3 gap-4">
                        {[
                            {id:'entry', l:'Entry', c:'bg-blue-500', i:I.plus},
                            {id:'invoices', l:'Invoices', c:'bg-indigo-500', i:I.print},
                            {id:'inventory', l:'Stock', c:'bg-orange-500', i:I.grid},
                            {id:'loans', l:'Loans', c:'bg-purple-500', i:'<rect x="2" y="5" width="20" height="14" rx="2"></rect><line x1="2" y1="10" x2="22" y2="10"></line>'},
                            {id:'contacts', l:'Contacts', c:'bg-pink-500', i:'<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle>'},
                            {id:'staff', l:'Staff', c:'bg-yellow-500', i:'<circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>'},
                            {id:'tasks', l:'Tasks', c:'bg-emerald-500', i:'<polyline points="9 11 12 14 22 4"></polyline><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>'},
                        ].filter(m=>modules[m.id]).map(b => (
                            <button key={b.id} onClick={()=>nav(b.id)} className="flex flex-col items-center gap-2 ios-btn">
                                <div className={`w-14 h-14 rounded-2xl ${b.c} text-white flex items-center justify-center shadow-lg shadow-gray-200`}><Icon p={b.i}/></div>
                                <span className="text-xs font-medium text-gray-600">{b.l}</span>
                            </button>
                        ))}
                    </div>
                </div>
            )
        };

        // --- ADVANCED STAFF MANAGER (NEW) ---
        const AdvancedStaffManager = ({ staff, setStaff, attendance, setAttendance, payments, setPayments }) => {
            const [view, setView] = useState('list'); // list, attend, pay
            
            // Sub-States
            const [newS, setNewS] = useState({ name:'', role:'', salary:'', type:'Daily' });
            const [mark, setMark] = useState({ date: new Date().toISOString().split('T')[0], id:'', inTime:'', outTime:'', note:'' });
            const [pay, setPay] = useState({ date: new Date().toISOString().split('T')[0], id:'', amt:'', type:'Salary' });

            const addStaff = () => { if(newS.name){ setStaff([...staff, {id:Date.now(), ...newS}]); setNewS({name:'',role:'',salary:'',type:'Daily'}); }};
            const delStaff = (id) => { if(confirm('Delete Staff?')) setStaff(staff.filter(s=>s.id!==id)); };

            const saveAttendance = () => {
                if(mark.id && mark.inTime) {
                    setAttendance([...attendance, {id:Date.now(), ...mark}]);
                    setMark({...mark, id:'', inTime:'', outTime:'', note:''});
                    alert('Attendance Marked');
                }
            };

            const savePayment = () => {
                if(pay.id && pay.amt) {
                    setPayments([...payments, {id:Date.now(), ...pay}]);
                    setPay({...pay, id:'', amt:''});
                    alert('Payment Recorded');
                }
            };

            // Helper to render Tabs
            const TabBtn = ({id, l}) => <button onClick={()=>setView(id)} className={`flex-1 py-2 text-sm font-bold rounded-lg transition-all ${view===id?'bg-white shadow text-yellow-600':'text-gray-500'}`}>{l}</button>;

            return (
                <div className="animate-enter space-y-4">
                    <div className="bg-gray-100 p-1 rounded-xl flex mb-2">
                        <TabBtn id="list" l="Staff List"/>
                        <TabBtn id="attend" l="Attendance"/>
                        <TabBtn id="pay" l="Payroll"/>
                    </div>

                    {view === 'list' && (
                        <div className="space-y-4">
                            <div className="ios-card">
                                <h3 className="font-bold mb-3">Add New Staff</h3>
                                <div className="space-y-3">
                                    <input placeholder="Name" className="ios-input" value={newS.name} onChange={e=>setNewS({...newS, name:e.target.value})}/>
                                    <div className="flex gap-2">
                                        <input placeholder="Role (e.g. Manager)" className="ios-input" value={newS.role} onChange={e=>setNewS({...newS, role:e.target.value})}/>
                                        <input placeholder="Salary" type="number" className="ios-input w-24" value={newS.salary} onChange={e=>setNewS({...newS, salary:e.target.value})}/>
                                    </div>
                                    <select className="ios-input" value={newS.type} onChange={e=>setNewS({...newS, type:e.target.value})}>
                                        <option value="Daily">Daily Wage</option>
                                        <option value="Monthly">Monthly Salary</option>
                                        <option value="Hourly">Hourly</option>
                                    </select>
                                    <button onClick={addStaff} className="bg-yellow-500 text-white w-full py-3 rounded-xl font-bold ios-btn">Add Staff</button>
                                </div>
                            </div>
                            <div className="space-y-2">
                                {staff.map(s=>(
                                    <div key={s.id} className="ios-card !p-3 flex justify-between items-center">
                                        <div>
                                            <div className="font-bold">{s.name}</div>
                                            <div className="text-xs text-gray-500">{s.role} • ₹{s.salary}/{s.type}</div>
                                        </div>
                                        <button onClick={()=>delStaff(s.id)} className="text-red-400 p-2"><Icon p={I.trash}/></button>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {view === 'attend' && (
                        <div className="space-y-4">
                            <div className="ios-card">
                                <h3 className="font-bold mb-3">Mark Attendance</h3>
                                <div className="space-y-3">
                                    <input type="date" className="ios-input" value={mark.date} onChange={e=>setMark({...mark, date:e.target.value})}/>
                                    <select className="ios-input" value={mark.id} onChange={e=>setMark({...mark, id:e.target.value})}>
                                        <option value="">Select Staff</option>
                                        {staff.map(s=><option key={s.id} value={s.id}>{s.name}</option>)}
                                    </select>
                                    <div className="grid grid-cols-2 gap-3">
                                        <div><label className="text-[10px] text-gray-500 pl-1">In Time</label><input type="time" className="ios-input" value={mark.inTime} onChange={e=>setMark({...mark, inTime:e.target.value})}/></div>
                                        <div><label className="text-[10px] text-gray-500 pl-1">Out Time</label><input type="time" className="ios-input" value={mark.outTime} onChange={e=>setMark({...mark, outTime:e.target.value})}/></div>
                                    </div>
                                    <input placeholder="Work Note (Optional)" className="ios-input" value={mark.note} onChange={e=>setMark({...mark, note:e.target.value})}/>
                                    <button onClick={saveAttendance} className="bg-black text-white w-full py-3 rounded-xl font-bold ios-btn">Save Record</button>
                                </div>
                            </div>
                            <div className="ios-card">
                                <h3 className="font-bold text-gray-800 mb-2">History</h3>
                                <div className="space-y-2 max-h-60 overflow-y-auto">
                                    {attendance.slice().reverse().map(a => {
                                        const s = staff.find(x=>x.id == a.id);
                                        if(!s) return null;
                                        return (
                                            <div key={a.id || Math.random()} className="p-2 border-b text-sm">
                                                <div className="flex justify-between font-bold"><span>{s.name}</span> <span className="text-gray-500 text-xs">{a.date}</span></div>
                                                <div className="text-xs text-gray-500 mt-1">In: {a.inTime || '-'} | Out: {a.outTime || '-'}</div>
                                                {a.note && <div className="text-xs bg-gray-50 p-1 mt-1 rounded italic">{a.note}</div>}
                                            </div>
                                        )
                                    })}
                                </div>
                            </div>
                        </div>
                    )}

                    {view === 'pay' && (
                        <div className="space-y-4">
                            <div className="ios-card">
                                <h3 className="font-bold mb-3">Record Payment</h3>
                                <div className="space-y-3">
                                    <select className="ios-input" value={pay.id} onChange={e=>setPay({...pay, id:e.target.value})}>
                                        <option value="">Select Staff</option>
                                        {staff.map(s=><option key={s.id} value={s.id}>{s.name}</option>)}
                                    </select>
                                    <div className="flex gap-2">
                                        <input type="number" placeholder="Amount" className="ios-input" value={pay.amt} onChange={e=>setPay({...pay, amt:e.target.value})}/>
                                        <select className="ios-input w-32" value={pay.type} onChange={e=>setPay({...pay, type:e.target.value})}>
                                            <option>Salary</option><option>Advance</option><option>Bonus</option>
                                        </select>
                                    </div>
                                    <button onClick={savePayment} className="bg-green-600 text-white w-full py-3 rounded-xl font-bold ios-btn">Pay</button>
                                </div>
                            </div>
                            <div className="space-y-2">
                                {staff.map(s => {
                                    const worked = attendance.filter(a => a.id == s.id).length;
                                    const paid = payments.filter(p => p.id == s.id).reduce((sum, p) => sum + parseFloat(p.amt), 0);
                                    let earned = 0;
                                    if(s.type === 'Daily') earned = worked * parseFloat(s.salary);
                                    if(s.type === 'Monthly') earned = parseFloat(s.salary);
                                    
                                    const bal = earned - paid;
                                    
                                    return (
                                        <div key={s.id} className="ios-card !p-3 flex justify-between items-center">
                                            <div>
                                                <div className="font-bold">{s.name}</div>
                                                <div className="text-xs text-gray-500">Days Present: {worked}</div>
                                            </div>
                                            <div className="text-right">
                                                <div className="text-[10px] text-gray-400">Est. Balance</div>
                                                <div className={`font-bold ${bal < 0 ? 'text-red-500' : 'text-green-600'}`}>{formatCurrency(bal)}</div>
                                            </div>
                                        </div>
                                    )
                                })}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const InventoryManager = ({inventory, setInventory}) => {
            const [form, setForm] = useState({name:'', qty:'', price:'', buyDate:'', insNum:'', insDate:''});
            const [expanded, setExpanded] = useState(null);

            const add = (e) => { 
                e.preventDefault(); 
                setInventory([...inventory, {id:Date.now(), ...form}]); 
                setForm({name:'',qty:'',price:'', buyDate:'', insNum:'', insDate:''}); 
            };

            const toggle = (id) => setExpanded(expanded === id ? null : id);
            
            const totalStockVal = inventory.reduce((s,i) => s + ((parseFloat(i.qty)||0) * (parseFloat(i.price)||0)), 0);

            return (
                <div className="animate-enter space-y-4">
                    <div className="ios-card bg-gradient-to-r from-orange-500 to-red-500 text-white border-none">
                        <div className="opacity-90 text-xs font-bold uppercase mb-1">Total Stock Value</div>
                        <div className="text-3xl font-bold">{formatCurrency(totalStockVal)}</div>
                    </div>

                    <div className="ios-card">
                        <h3 className="font-bold text-gray-800 mb-4">Add New Item</h3>
                        <form onSubmit={add} className="space-y-3">
                            <input placeholder="Item Name *" className="ios-input font-medium" value={form.name} onChange={e=>setForm({...form,name:e.target.value})} required/>
                            <div className="grid grid-cols-2 gap-3">
                                <input type="number" placeholder="Qty *" className="ios-input" value={form.qty} onChange={e=>setForm({...form,qty:e.target.value})} required/>
                                <input type="number" placeholder="Price (₹) *" className="ios-input" value={form.price} onChange={e=>setForm({...form,price:e.target.value})} required/>
                            </div>
                            <div className="grid grid-cols-2 gap-3">
                                <div><label className="text-[10px] text-gray-500 pl-1">Buying Date</label><input type="date" className="ios-input" value={form.buyDate} onChange={e=>setForm({...form,buyDate:e.target.value})}/></div>
                                <div><label className="text-[10px] text-gray-500 pl-1">Insurance Date</label><input type="date" className="ios-input" value={form.insDate} onChange={e=>setForm({...form,insDate:e.target.value})}/></div>
                            </div>
                            <input placeholder="Insurance Number" className="ios-input" value={form.insNum} onChange={e=>setForm({...form,insNum:e.target.value})}/>
                            <button className="w-full bg-black text-white py-3 rounded-xl font-bold ios-btn">Add to Stock</button>
                        </form>
                    </div>

                    <div className="space-y-3 pb-10">
                        {inventory.map(i=>(
                            <div key={i.id} className="ios-card !p-0 overflow-hidden">
                                <div className="p-4 flex justify-between items-center cursor-pointer" onClick={()=>toggle(i.id)}>
                                    <div>
                                        <div className="font-bold text-base">{i.name}</div>
                                        <div className="text-xs text-gray-500 mt-0.5">{i.qty} units x ₹{i.price}</div>
                                    </div>
                                    <div className="flex items-center gap-3">
                                        <div className="font-bold text-green-600">{formatCurrency((parseFloat(i.qty)||0)*(parseFloat(i.price)||0))}</div>
                                        <div className={`transition-transform duration-200 text-gray-400 ${expanded===i.id?'rotate-180':''}`}><Icon p={I.chevronD}/></div>
                                    </div>
                                </div>
                                <div className={`bg-gray-50 px-4 text-sm text-gray-600 details-content ${expanded===i.id ? 'details-open py-4 border-t' : ''}`}>
                                    <div className="grid grid-cols-2 gap-y-2">
                                        <div><span className="text-xs text-gray-400 block">Buy Date</span>{i.buyDate || '-'}</div>
                                        <div><span className="text-xs text-gray-400 block">Insurance No</span>{i.insNum || '-'}</div>
                                        <div><span className="text-xs text-gray-400 block">Ins. Date</span>{i.insDate || '-'}</div>
                                    </div>
                                    <div className="mt-4 pt-3 border-t border-gray-200 flex justify-end">
                                        <button onClick={(e)=>{e.stopPropagation(); if(confirm('Delete?')) setInventory(inventory.filter(x=>x.id!==i.id))}} className="text-red-500 text-xs font-bold flex items-center gap-1 bg-white border border-red-100 px-3 py-1.5 rounded-lg"><Icon p={I.trash} c="w-3 h-3"/> Delete Item</button>
                                    </div>
                                </div>
                            </div>
                        ))}
                        {inventory.length === 0 && <div className="text-center text-gray-400 py-10">No items available.</div>}
                    </div>
                </div>
            );
        };

        const InvoiceManager = ({ invoices, setInvoices, company, contacts, items, setItems }) => {
            const [mode, setMode] = useState('list');
            const [printInv, setPrintInv] = useState(null);
            
            const [inv, setInv] = useState({ client:'', date: new Date().toISOString().split('T')[0], items: [] });
            const [line, setLine] = useState({ desc:'', qty:1, price:0 });
            
            const addItem = () => { if(line.desc){ setInv({...inv, items:[...inv.items, line]}); setLine({desc:'', qty:1, price:0}); }};
            const save = () => { 
                if(inv.client && inv.items.length){
                    const total = inv.items.reduce((s,i)=>s+(i.qty*i.price),0);
                    setInvoices([{id:Date.now(), ...inv, total}, ...invoices]);
                    setMode('list'); setInv({client:'', date: new Date().toISOString().split('T')[0], items:[]});
                }
            };

            const openPrint = (i) => { setPrintInv(i); setMode('preview'); };

            if(mode === 'preview' && printInv) return (
                <div className="fixed inset-0 z-50 bg-gray-900/50 flex items-center justify-center p-4">
                    <div className="bg-white w-full max-w-2xl h-[90vh] rounded-3xl overflow-hidden flex flex-col shadow-2xl animate-enter">
                        <div className="p-4 bg-gray-50 border-b flex justify-between items-center no-print">
                            <h3 className="font-bold">Preview</h3>
                            <div className="flex gap-2">
                                <button onClick={()=>setMode('list')} className="px-4 py-2 bg-gray-200 rounded-xl font-bold text-sm">Close</button>
                                <button onClick={()=>window.print()} className="px-4 py-2 bg-blue-600 text-white rounded-xl font-bold text-sm shadow-md shadow-blue-200">Print</button>
                            </div>
                        </div>
                        {/* Printable Content */}
                        <div id="print-preview-modal" className="flex-1 overflow-y-auto p-10 text-black bg-white">
                            <div className="flex justify-between items-start border-b-2 border-black pb-4 mb-6">
                                <div>
                                    <h1 className="text-3xl font-bold uppercase">{company.name}</h1>
                                    <p className="text-sm mt-1 whitespace-pre-line text-gray-600">{company.address}</p>
                                    <p className="text-sm text-gray-600">Ph: {company.phone}</p>
                                </div>
                                <div className="text-right">
                                    <h2 className="text-4xl font-light text-gray-300">INVOICE</h2>
                                    <p className="font-bold">#{printInv.id.toString().slice(-4)}</p>
                                    <p className="text-sm">{printInv.date}</p>
                                </div>
                            </div>
                            <div className="mb-8">
                                <p className="text-xs font-bold text-gray-400 uppercase">Bill To</p>
                                <h3 className="text-xl font-bold">{printInv.client}</h3>
                            </div>
                            <table className="w-full mb-8 border-collapse">
                                <thead><tr className="border-b-2 border-black text-sm uppercase"><th className="py-2 text-left">Item</th><th className="py-2 text-right">Qty</th><th className="py-2 text-right">Price</th><th className="py-2 text-right">Total</th></tr></thead>
                                <tbody>
                                    {printInv.items.map((i,x)=>(
                                        <tr key={x} className="border-b border-gray-200 text-sm">
                                            <td className="py-2">{i.desc}</td><td className="py-2 text-right">{i.qty}</td><td className="py-2 text-right">{i.price}</td><td className="py-2 text-right font-bold">{formatCurrency(i.qty*i.price)}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                            <div className="text-right text-2xl font-bold border-t-2 border-black pt-4">Total: {formatCurrency(printInv.total)}</div>
                            <div className="mt-20 flex justify-between items-end">
                                <div className="text-xs text-gray-400">Thank you!</div>
                                <div className="text-center"><div className="w-40 border-b border-black mb-1"></div><div className="text-xs font-bold">Authorized Signature</div></div>
                            </div>
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="animate-enter space-y-4">
                    {mode === 'list' ? (
                        <div className="ios-card">
                            <div className="flex justify-between items-center mb-4">
                                <h3 className="font-bold text-lg">Invoices</h3>
                                <button onClick={()=>setMode('create')} className="bg-blue-100 text-blue-600 p-2 rounded-xl"><Icon p={I.plus}/></button>
                            </div>
                            <div className="space-y-3">
                                {invoices.map(i=>(
                                    <div key={i.id} className="flex justify-between items-center p-3 bg-gray-50 rounded-xl">
                                        <div><div className="font-bold">{i.client}</div><div className="text-xs text-gray-500">{i.date} • #{i.id.toString().slice(-4)}</div></div>
                                        <div className="flex items-center gap-3">
                                            <span className="font-bold text-gray-700">{formatCurrency(i.total)}</span>
                                            <button onClick={()=>openPrint(i)} className="bg-white p-2 rounded-lg shadow-sm border"><Icon p={I.print}/></button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    ) : (
                        <div className="ios-card">
                            <div className="flex justify-between items-center mb-4"><h3 className="font-bold">New Invoice</h3><button onClick={()=>setMode('list')} className="text-red-500 text-sm font-bold">Cancel</button></div>
                            <div className="space-y-3">
                                <div className="grid grid-cols-2 gap-3">
                                    <input placeholder="Client" list="contacts" className="ios-input" value={inv.client} onChange={e=>setInv({...inv, client:e.target.value})}/>
                                    <datalist id="contacts">{contacts.map(c=><option key={c.id} value={c.name}/>)}</datalist>
                                    <input type="date" className="ios-input" value={inv.date} onChange={e=>setInv({...inv, date:e.target.value})}/>
                                </div>
                                <div className="bg-gray-50 p-3 rounded-xl space-y-2 border">
                                    <div className="flex gap-2">
                                        <input placeholder="Item Description" list="items" className="ios-input flex-1" value={line.desc} onChange={e=>{
                                            const val=e.target.value; const f=items.find(x=>x.name===val);
                                            setLine({...line, desc:val, price:f?f.price:line.price});
                                        }}/>
                                        <datalist id="items">{items.map(i=><option key={i.id} value={i.name}/>)}</datalist>
                                    </div>
                                    <div className="flex gap-2">
                                        <input type="number" placeholder="Qty" className="ios-input w-20" value={line.qty} onChange={e=>setLine({...line, qty:e.target.value})}/>
                                        <input type="number" placeholder="Price" className="ios-input w-24" value={line.price} onChange={e=>setLine({...line, price:e.target.value})}/>
                                        <button onClick={addItem} className="bg-black text-white px-4 rounded-xl font-bold">Add</button>
                                    </div>
                                </div>
                                <div className="space-y-1">
                                    {inv.items.map((x,i)=><div key={i} className="flex justify-between text-sm px-2"><span>{x.desc} x {x.qty}</span><span className="font-mono">{formatCurrency(x.qty*x.price)}</span></div>)}
                                    <div className="border-t pt-2 mt-2 flex justify-between font-bold text-lg"><span>Total</span><span>{formatCurrency(inv.items.reduce((s,x)=>s+(x.qty*x.price),0))}</span></div>
                                </div>
                                <button onClick={save} className="w-full bg-blue-600 text-white py-3 rounded-xl font-bold shadow-lg shadow-blue-200 ios-btn">Create Invoice</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const EntryManager = ({ txns, setTxns, cats, projects }) => {
            const [form, setForm] = useState({ date: new Date().toISOString().split('T')[0], type:'exp', cat:'', proj:'General', amt:'' });
            const [editId, setEditId] = useState(null);
            const save = (e) => { e.preventDefault(); if(editId) { setTxns(txns.map(t => t.id === editId ? { ...form, id: editId } : t)); setEditId(null); } else { setTxns([{id:Date.now(), ...form}, ...txns]); } setForm({ ...form, amt:'' }); };
            const edit = (t) => { setForm(t); setEditId(t.id); };
            const del = (id) => { if(confirm("Delete?")) setTxns(txns.filter(t=>t.id!==id)); };
            return (<div className="animate-enter space-y-4"><div className="ios-card"><div className="flex bg-gray-100 p-1 rounded-xl mb-4"><button onClick={()=>setForm({...form, type:'inc'})} className={`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${form.type==='inc'?'bg-white shadow text-green-600':'text-gray-500'}`}>Income</button><button onClick={()=>setForm({...form, type:'exp'})} className={`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${form.type==='exp'?'bg-white shadow text-red-600':'text-gray-500'}`}>Expense</button></div><form onSubmit={save} className="space-y-3"><div className="grid grid-cols-2 gap-3"><input type="date" className="ios-input" value={form.date} onChange={e=>setForm({...form, date:e.target.value})}/><input type="number" placeholder="Amount" className="ios-input font-bold" value={form.amt} onChange={e=>setForm({...form, amt:e.target.value})} required/></div><select className="ios-input" value={form.cat} onChange={e=>setForm({...form, cat:e.target.value})} required><option value="">Category</option>{(form.type==='inc'?cats.inc:cats.exp).map(c=><option key={c} value={c}>{c}</option>)}</select><select className="ios-input" value={form.proj} onChange={e=>setForm({...form, proj:e.target.value})}>{projects.map(p=><option key={p} value={p}>{p}</option>)}</select><button className={`w-full py-3 rounded-xl font-bold text-white shadow-lg ios-btn ${form.type==='inc'?'bg-green-500 shadow-green-200':'bg-red-500 shadow-red-200'}`}>{editId?'Update':'Save'}</button></form></div><div className="ios-card"><h3 className="font-bold text-gray-800 mb-3">Recent Transactions</h3><div className="space-y-3 max-h-[400px] overflow-y-auto">{txns.map(t => (<div key={t.id} className="flex justify-between items-center p-3 rounded-xl bg-gray-50 border border-gray-100"><div><div className="font-bold text-sm">{t.cat}</div><div className="text-[10px] text-gray-400">{t.date} • {t.proj}</div></div><div className="flex items-center gap-3"><span className={`font-bold ${t.type==='inc'?'text-green-600':'text-red-600'}`}>{t.type==='inc'?'+':'-'} {t.amt}</span><button onClick={()=>edit(t)} className="text-blue-500"><Icon p={I.edit} c="w-4 h-4"/></button><button onClick={()=>del(t.id)} className="text-gray-400"><Icon p={I.trash} c="w-4 h-4"/></button></div></div>))}</div></div></div>);
        };

        const SettingsManager = ({ company, setCompany, projects, setProjects, cats, setCats, modules, setModules, fullData }) => {
            const [tab, setTab] = useState('company'); const [val, setVal] = useState('');
            const addProj = () => { if(val){ setProjects([...projects, val]); setVal(''); }};
            const addCat = (t) => { if(val){ setCats({...cats, [t]:[...cats[t], val]}); setVal(''); }};
            const delCat = (t, i) => { setCats({...cats, [t]: cats[t].filter((_,x)=>x!==i)}); };
            const delProj = (i) => setProjects(projects.filter((_,x)=>x!==i));
            const downloadBackup = () => { const ws = XLSX.utils.json_to_sheet(fullData.txns); const wb = XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb, ws, "Transactions"); XLSX.writeFile(wb, "Backup.xlsx"); };
            const NavBtn = ({id, label}) => <button onClick={()=>setTab(id)} className={`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap transition-colors ${tab===id?'bg-black text-white':'bg-gray-100 text-gray-600'}`}>{label}</button>;
            return (<div className="animate-enter"><div className="flex overflow-x-auto gap-2 mb-4 pb-1 hide-scroll"><NavBtn id="company" label="Company"/><NavBtn id="projects" label="Projects"/><NavBtn id="cats" label="Categories"/><NavBtn id="modules" label="Modules"/><NavBtn id="data" label="Data"/></div><div className="ios-card">{tab==='company'&&( <div className="space-y-3"><h3 className="font-bold mb-2">Business Details</h3><input className="ios-input" placeholder="Company Name" value={company.name} onChange={e=>setCompany({...company, name:e.target.value})}/><textarea className="ios-input" rows="3" placeholder="Address" value={company.address} onChange={e=>setCompany({...company, address:e.target.value})}/><input className="ios-input" placeholder="Phone" value={company.phone} onChange={e=>setCompany({...company, phone:e.target.value})}/></div> )}{tab==='projects'&&( <div><div className="flex gap-2 mb-4"><input className="ios-input" placeholder="New Project" value={val} onChange={e=>setVal(e.target.value)}/><button onClick={addProj} className="bg-black text-white px-4 rounded-xl font-bold">Add</button></div><div className="space-y-2">{projects.map((p,i)=><div key={i} className="flex justify-between p-3 bg-gray-50 rounded-xl font-medium">{p}<button onClick={()=>delProj(i)} className="text-red-500"><Icon p={I.trash}/></button></div>)}</div></div> )}{tab==='cats'&&( <div className="space-y-6"><div><div className="flex justify-between items-center mb-2"><h4 className="font-bold text-sm text-green-600">Income Categories</h4><div className="flex gap-2"><input className="bg-gray-100 p-1 rounded text-sm w-24" id="newInc"/><button onClick={()=>{setVal(document.getElementById('newInc').value); addCat('inc'); document.getElementById('newInc').value=''}} className="text-xs bg-green-100 text-green-700 px-2 rounded">Add</button></div></div><div className="flex flex-wrap gap-2">{cats.inc.map((c,i)=><span key={i} className="bg-green-50 text-green-800 px-3 py-1 rounded-full text-xs font-bold border border-green-100 flex items-center gap-1">{c}<button onClick={()=>delCat('inc',i)}>×</button></span>)}</div></div><div><div className="flex justify-between items-center mb-2"><h4 className="font-bold text-sm text-red-600">Expense Categories</h4><div className="flex gap-2"><input className="bg-gray-100 p-1 rounded text-sm w-24" id="newExp"/><button onClick={()=>{setVal(document.getElementById('newExp').value); addCat('exp'); document.getElementById('newExp').value=''}} className="text-xs bg-red-100 text-red-700 px-2 rounded">Add</button></div></div><div className="flex flex-wrap gap-2">{cats.exp.map((c,i)=><span key={i} className="bg-red-50 text-red-800 px-3 py-1 rounded-full text-xs font-bold border border-red-100 flex items-center gap-1">{c}<button onClick={()=>delCat('exp',i)}>×</button></span>)}</div></div></div> )}{tab==='modules'&&( <div className="grid grid-cols-2 gap-3">{Object.keys(modules).map(k=>(<label key={k} className={`flex items-center gap-3 p-3 rounded-xl border-2 cursor-pointer transition-all ${modules[k]?'border-blue-500 bg-blue-50':'border-transparent bg-gray-50'}`}><input type="checkbox" checked={modules[k]} onChange={()=>setModules({...modules, [k]:!modules[k]})} className="hidden"/><span className="capitalize font-bold text-sm">{k}</span></label>))}</div> )}{tab==='data'&&( <div className="text-center py-6"><div className="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-500"><Icon p={I.download} c="w-8 h-8"/></div><h3 className="font-bold text-lg mb-1">Backup Data</h3><p className="text-gray-500 text-xs mb-4">Download all records as Excel file</p><button onClick={downloadBackup} className="bg-black text-white px-6 py-3 rounded-xl font-bold shadow-lg ios-btn">Download .xlsx</button></div> )}</div></div>);
        };

        const LoanManager = ({loans, setLoans, contacts}) => {
            const [form, setForm] = useState({name:'', amount:'', type:'Given'});
            const add = (e) => { e.preventDefault(); setLoans([...loans, {id:Date.now(), ...form, paid:0}]); setForm({...form, amount:''}); };
            return (<div className="animate-enter"><div className="ios-card"><div className="flex justify-between mb-4"><h3 className="font-bold">Loans</h3></div><form onSubmit={add} className="flex gap-2 mb-4 flex-wrap"><input placeholder="Person" list="cnt" className="ios-input flex-1 min-w-[120px]" value={form.name} onChange={e=>setForm({...form,name:e.target.value})}/><datalist id="cnt">{contacts.map(c=><option key={c.id} value={c.name}/>)}</datalist><input type="number" placeholder="Amt" className="ios-input w-24" value={form.amount} onChange={e=>setForm({...form,amount:e.target.value})}/><select className="ios-input w-24" value={form.type} onChange={e=>setForm({...form,type:e.target.value})}><option value="Given">Given</option><option value="Taken">Taken</option></select><button className="bg-purple-600 text-white px-4 rounded-xl font-bold w-full sm:w-auto">Save</button></form><div className="space-y-2">{loans.map(l=>{const bal=l.amount-(l.paid||0); if(bal<=0) return null; return(<div key={l.id} className="p-3 bg-gray-50 rounded-xl flex justify-between items-center"><div><div className="font-bold text-sm">{l.name} <span className={`text-[10px] px-1 rounded ${l.type==='Given'?'bg-red-100 text-red-700':'bg-green-100 text-green-700'}`}>{l.type}</span></div><div className="text-xs text-gray-500">Bal: {bal} / {l.amount}</div></div><button onClick={()=>{const p=prompt('Pay amount'); if(p) setLoans(loans.map(x=>x.id===l.id?{...x, paid:(x.paid||0)+parseFloat(p)}:x))}} className="text-xs bg-white border px-3 py-1 rounded-lg font-bold text-blue-600 shadow-sm">Pay</button></div>)})}</div></div></div>);
        };

        const ContactManager = ({contacts, setContacts}) => { 
            const [f, sF] = useState({name:'',phone:''}); const [search, setSearch] = useState('');
            const filtered = contacts.filter(c => c.name.toLowerCase().includes(search.toLowerCase()) || c.phone.includes(search));
            return (<div className="animate-enter"><div className="ios-card"><form onSubmit={(e)=>{e.preventDefault(); setContacts([...contacts,{id:Date.now(),...f}]); sF({name:'',phone:''})}} className="flex gap-2 mb-4"><input placeholder="Name" className="ios-input" value={f.name} onChange={e=>sF({...f,name:e.target.value})}/><input placeholder="Phone" className="ios-input w-32" value={f.phone} onChange={e=>sF({...f,phone:e.target.value})}/><button className="bg-pink-500 text-white px-4 rounded-xl">+</button></form><input placeholder="Search..." className="ios-input mb-3 bg-gray-100" value={search} onChange={e=>setSearch(e.target.value)}/><div className="space-y-2 max-h-[50vh] overflow-y-auto">{filtered.map(c=>(<div key={c.id} className="flex justify-between p-3 bg-gray-50 rounded-xl"><div><div className="font-bold">{c.name}</div><div className="text-xs text-gray-500">{c.phone}</div></div><button onClick={()=>setContacts(contacts.filter(x=>x.id!==c.id))} className="text-gray-400"><Icon p={I.trash}/></button></div>))}</div></div></div>);
        };

        const TaskManager = ({tasks, setTasks}) => { const [t, sT] = useState(''); return (<div className="animate-enter"><div className="ios-card"><div className="flex gap-2 mb-4"><input className="ios-input" placeholder="New Task" value={t} onChange={e=>sT(e.target.value)}/><button onClick={()=>{if(t){setTasks([...tasks,{id:Date.now(),t,d:false}]); sT('')}}} className="bg-emerald-500 text-white px-4 rounded-xl font-bold">+</button></div><div className="space-y-2">{tasks.sort((a,b)=>a.d-b.d).map(x=>(<div key={x.id} className={`p-3 rounded-xl flex items-center gap-3 transition-all ${x.d?'bg-gray-100 opacity-50':'bg-white border'}`}><input type="checkbox" checked={x.d} onChange={()=>setTasks(tasks.map(k=>k.id===x.id?{...k,d:!k.d}:k))} className="w-5 h-5 rounded-md accent-emerald-500"/><span className={x.d?'line-through':''}>{x.t}</span></div>))}</div></div></div>)};
        const StaffManager = ({staff, setStaff}) => { const [n, sN] = useState(''); return (<div className="animate-enter"><div className="ios-card"><div className="flex gap-2 mb-4"><input placeholder="Staff Name" className="ios-input" value={n} onChange={e=>sN(e.target.value)}/><button onClick={()=>{setStaff([...staff,{id:Date.now(),name:n}]); sN('')}} className="bg-yellow-500 text-white px-4 rounded-xl">Add</button></div><div className="space-y-2">{staff.map(s=>(<div key={s.id} className="p-3 bg-gray-50 rounded-xl font-bold text-gray-700">{s.name}</div>))}</div></div></div>)};

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
